{% extends "base.html" %}
{% block title %}–î–∞—à–±–æ—Ä–¥{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto p-6">

  <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∞–≤–∞—Ç–∞—Ä -->
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center space-x-4">
      <img src="https://ui-avatars.com/api/?name={{ user.get_full_name }}" alt="avatar"
           class="w-12 h-12 rounded-full shadow">
      <div>
        <h1 class="text-xl font-bold">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.get_full_name }}</h1>
        <p class="text-sm text-gray-500">–†–æ–ª—å: {{ user.role|title }}</p>
      </div>
    </div>
    <form action="{% url 'logout' %}" method="post">
      {% csrf_token %}
      <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
        –í—ã–π—Ç–∏
      </button>
    </form>
  </div>

  <!-- –°–æ–≤–µ—Ç –¥–Ω—è -->
  <div class="bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded mb-6">
    <p class="font-semibold">üí¨ –°–æ–≤–µ—Ç –¥–Ω—è:</p>
    <p class="text-sm">–ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ—Ç–º–µ—Ç–∏—Ç—å —è–≤–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –∑–∞–±—ã–ª–∏ –ª–∏ –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –æ—Ç–ø—É—Å–∫.</p>
  </div>

  {% if user.role == 'worker' %}
    <!-- –†–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <div class="bg-white shadow p-4 rounded-lg text-center">
        <div class="text-sm text-gray-500">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
        <div class="text-2xl font-bold text-green-600">{{ worked_days }} –¥–Ω.</div>
      </div>
      <div class="bg-white shadow p-4 rounded-lg text-center">
        <div class="text-sm text-gray-500">–û—Ç–ø—É—Å–∫</div>
        <div class="text-2xl font-bold text-blue-600">{{ vacation_days }} –¥–Ω.</div>
      </div>
      <div class="bg-white shadow p-4 rounded-lg text-center">
        <div class="text-sm text-gray-500">–ë–æ–ª—å–Ω–∏—á–Ω—ã–π</div>
        <div class="text-2xl font-bold text-yellow-600">{{ sick_days }} –¥–Ω.</div>
      </div>
      <div class="bg-white shadow p-4 rounded-lg text-center">
        <div class="text-sm text-gray-500">–ü—Ä–æ–ø—É—â–µ–Ω–æ</div>
        <div class="text-2xl font-bold text-red-600">{{ absent_days }} –¥–Ω.</div>
      </div>
    </div>
  {% endif %}

  <!-- –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
    {% if user.role == 'worker' %}
      <a href="{% url 'attendance' %}"
         class="bg-blue-500 hover:bg-blue-600 text-white p-6 rounded-xl text-center text-lg font-semibold shadow">
        üìÖ –ú–æ–π —Ç–∞–±–µ–ª—å
      </a>
      <a href="{% url 'leave_request' %}"
         class="bg-green-500 hover:bg-green-600 text-white p-6 rounded-xl text-center text-lg font-semibold shadow">
        üìù –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É
      </a>
    {% elif user.role == 'editor' %}
      <a href="{% url 'edit_attendance' %}"
         class="bg-yellow-500 hover:bg-yellow-600 text-white p-6 rounded-xl text-center text-lg font-semibold shadow">
        üõ† –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
      </a>
    {% elif user.role == 'approver' %}
      <a href="{% url 'approve_requests' %}"
         class="bg-indigo-500 hover:bg-indigo-600 text-white p-6 rounded-xl text-center text-lg font-semibold shadow">
        üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–æ–∫ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
      </a>
    {% elif user.role == 'admin' %}
      <a href="{% url 'user_management' %}"
         class="bg-gray-800 hover:bg-gray-700 text-white p-6 rounded-xl text-center text-lg font-semibold shadow">
        üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
      </a>
    {% endif %}
  </div>

  <!-- –ò–Ω—Ñ–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
  {% if user.role == 'editor' %}
    <div class="bg-white p-4 rounded shadow mb-8">
      <h2 class="text-lg font-semibold mb-2">üìä –ó–∞–¥–∞—á–∞</h2>
      <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–µ–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∑–∞ —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–Ω–µ—Å–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏.</p>
    </div>
  {% endif %}

  <!-- –ò–Ω—Ñ–æ –¥–ª—è —Å–æ–≥–ª–∞—Å—É—é—â–µ–≥–æ -->
  {% if user.role == 'approver' %}
    <div class="bg-white p-4 rounded shadow mb-8">
      <h2 class="text-lg font-semibold mb-2">üì• –ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</h2>
      <p>–û—Ç–∫—Ä–æ–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.</p>
    </div>
  {% endif %}

  <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏ ‚Äî worker -->
  {% if user.role == 'worker' %}
    <h2 class="text-xl font-semibold mb-2">üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏</h2>
    <ul class="space-y-2">
      {% for req in my_requests %}
        <li class="bg-white p-3 rounded shadow flex justify-between items-center">
          <span>{{ req.get_leave_type_display }}: {{ req.start_date }} ‚Äì {{ req.end_date }}</span>
          <span class="text-sm font-medium
            {% if req.status == 'approved' %}text-green-600
            {% elif req.status == 'rejected' %}text-red-600
            {% else %}text-yellow-600{% endif %}">
            {% if req.status == 'approved' %}‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ
            {% elif req.status == 'rejected' %}‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ
            {% else %}‚è≥ –í –æ–∂–∏–¥–∞–Ω–∏–∏{% endif %}
          </span>
        </li>
      {% empty %}
        <li class="text-sm text-gray-500">–ù–µ—Ç –∑–∞—è–≤–æ–∫.</li>
      {% endfor %}
    </ul>
  {% endif %}

</div>
{% endblock %}
